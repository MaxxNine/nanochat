{
  "script": "dynamic_block_update_schedule_bench.py",
  "timestamp_utc": "2026-02-25T19:04:09Z",
  "config": {
    "device_arg": "cpu",
    "resolved_device": "cpu",
    "dtype": "float32",
    "seed": 42,
    "dmodel": 128,
    "n_layers": 6,
    "hidden_mult": 2,
    "batch_size": 2,
    "seq_len": 64,
    "steps": 20,
    "lr": 0.0003,
    "weight_decay": 0.0,
    "teacher_noise": 0.02,
    "val_batches": 2,
    "warmup_ignore_steps": 5,
    "static_active_layers": 2,
    "dyn_warmup_steps": 5,
    "dyn_probe_every": 4,
    "dyn_refresh_every": 10,
    "dyn_relevance_threshold": 0.9,
    "dyn_min_active_layers": 2,
    "dyn_ema_decay": 0.9,
    "dyn_eps": 1e-08
  },
  "system": {
    "cuda_available": false,
    "cuda_device_name": null,
    "torch_version": "2.9.1+cu128"
  },
  "results": [
    {
      "schedule": "full_update",
      "final_val_loss": 0.052646152675151825,
      "train_loss_start": 0.10606145113706589,
      "train_loss_end": 0.053634993731975555,
      "mean_step_ms": 3.018161532963859,
      "p50_step_ms": 2.940291999038891,
      "p90_step_ms": 3.1438019996130606,
      "speedup_vs_full": 1.0,
      "active_layers_mean": 6.0,
      "active_layers_min": 6,
      "active_layers_max": 6,
      "probe_step_count": 0,
      "notes": "full update"
    },
    {
      "schedule": "static_suffix",
      "final_val_loss": 0.06756794080138206,
      "train_loss_start": 0.10625993460416794,
      "train_loss_end": 0.07086169719696045,
      "mean_step_ms": 1.5458503333017386,
      "p50_step_ms": 1.490003000071738,
      "p90_step_ms": 1.670370000283583,
      "speedup_vs_full": 1.9524280377890477,
      "active_layers_mean": 2.0,
      "active_layers_min": 2,
      "active_layers_max": 2,
      "probe_step_count": 0,
      "notes": "static active suffix=2"
    },
    {
      "schedule": "dynamic_suffix",
      "final_val_loss": 0.0527013149112463,
      "train_loss_start": 0.10626213252544403,
      "train_loss_end": 0.053900498896837234,
      "mean_step_ms": 3.1578397999207177,
      "p50_step_ms": 3.032824000911205,
      "p90_step_ms": 3.4941669982799795,
      "speedup_vs_full": 0.9557677793026849,
      "active_layers_mean": 6.0,
      "active_layers_min": 6,
      "active_layers_max": 6,
      "probe_step_count": 9,
      "notes": "dynamic relevance-guided active suffix"
    }
  ],
  "traces": {
    "full_update": {
      "step_times_ms": [
        8.11472799978219,
        3.308659999675001,
        3.9280769997276366,
        2.951784001197666,
        2.8729969999403693,
        2.8653019999183016,
        2.9708189995290013,
        2.9159170007915236,
        3.0115549998299684,
        2.860632999727386,
        2.833873999406933,
        4.007384999567876,
        2.940291999038891,
        3.112352998869028,
        2.938247998827137,
        2.9479459990398027,
        2.857358000255772,
        2.9616819992952514,
        3.1438019996130606,
        2.9052570007479517
      ],
      "train_losses": [
        0.10606145113706589,
        0.0991494283080101,
        0.09141726791858673,
        0.08918788284063339,
        0.08779001235961914,
        0.08280280232429504,
        0.08058103919029236,
        0.07848659157752991,
        0.07538919895887375,
        0.07147415727376938,
        0.07082254439592361,
        0.06713829934597015,
        0.06655574589967728,
        0.06444848328828812,
        0.061610929667949677,
        0.060430992394685745,
        0.058125630021095276,
        0.055908653885126114,
        0.05596281588077545,
        0.053634993731975555
      ],
      "active_layers_hist": [
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6
      ],
      "dynamic_trace": []
    },
    "static_suffix": {
      "step_times_ms": [
        2.3344999990513315,
        1.5926760006550467,
        1.4847729999019066,
        1.4425350000237813,
        1.4517020008497639,
        1.470576999054174,
        1.670370000283583,
        1.575963999130181,
        1.4981490003265208,
        1.4817769988439977,
        1.4562300002580741,
        1.5241870005411329,
        1.490003000071738,
        2.187316000345163,
        1.4842330001556547,
        1.4585449989681365,
        1.5296780002245214,
        1.426975999493152,
        1.495774000431993,
        1.4379760013980558
      ],
      "train_losses": [
        0.10625993460416794,
        0.10120944678783417,
        0.09616844356060028,
        0.09540002793073654,
        0.0913451761007309,
        0.09114622324705124,
        0.08864918351173401,
        0.08723519742488861,
        0.085580974817276,
        0.08263339102268219,
        0.08105923980474472,
        0.07943080365657806,
        0.07921421527862549,
        0.07853875309228897,
        0.0768149122595787,
        0.07542339712381363,
        0.07469841092824936,
        0.07231032103300095,
        0.06979941576719284,
        0.07086169719696045
      ],
      "active_layers_hist": [
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2
      ],
      "dynamic_trace": []
    },
    "dynamic_suffix": {
      "step_times_ms": [
        4.99946799936879,
        3.6586240003089188,
        3.2015600008890033,
        3.305813999759266,
        3.490580000288901,
        2.900548000980052,
        2.842099000190501,
        3.093327999522444,
        3.280286999142845,
        3.032824000911205,
        3.2272479984385427,
        2.934031001132098,
        4.5780609998473665,
        2.950301000964828,
        3.041621999727795,
        2.951402999315178,
        3.4941669982799795,
        3.037713000594522,
        2.994943999510724,
        3.0090210002526874
      ],
      "train_losses": [
        0.10626213252544403,
        0.09825529903173447,
        0.09377781301736832,
        0.09344934672117233,
        0.08785293996334076,
        0.08541922271251678,
        0.08175069838762283,
        0.07821524143218994,
        0.07541808485984802,
        0.07492297142744064,
        0.0682925209403038,
        0.06779570877552032,
        0.06632614135742188,
        0.06324096769094467,
        0.06364843994379044,
        0.05925067514181137,
        0.0588604174554348,
        0.057852499186992645,
        0.05592033267021179,
        0.053900498896837234
      ],
      "active_layers_hist": [
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6
      ],
      "dynamic_trace": [
        {
          "step": 0,
          "probe": true,
          "active_start_next": 0,
          "active_layers_next": 6,
          "ema_scores": [
            0.0004521440157776376,
            0.0004386200181603729,
            0.0004351470810363251,
            0.00041398412506288545,
            0.00042335362399929956,
            0.00040233194438693207
          ]
        },
        {
          "step": 1,
          "probe": true,
          "active_start_next": 0,
          "active_layers_next": 6,
          "ema_scores": [
            0.0007806311786637333,
            0.0007627021235400875,
            0.0007439370101550561,
            0.000697297603348508,
            0.0007050255826111148,
            0.0006670876289957898
          ]
        },
        {
          "step": 2,
          "probe": true,
          "active_start_next": 0,
          "active_layers_next": 6,
          "ema_scores": [
            0.001063410333618634,
            0.0010237576786764858,
            0.000996721180867982,
            0.0009386598077981609,
            0.0009348510430469303,
            0.0008903761709316985
          ]
        },
        {
          "step": 3,
          "probe": true,
          "active_start_next": 0,
          "active_layers_next": 6,
          "ema_scores": [
            0.0013274083494939463,
            0.0012806011104470663,
            0.0012390670518743771,
            0.0011772482687184913,
            0.0011545764632783211,
            0.0011076693484690912
          ]
        },
        {
          "step": 4,
          "probe": true,
          "active_start_next": 0,
          "active_layers_next": 6,
          "ema_scores": [
            0.0015318933210260893,
            0.0014729186824307228,
            0.0014242404724662038,
            0.0013500056752929876,
            0.001324451774676686,
            0.0012731034198067604
          ]
        },
        {
          "step": 8,
          "probe": true,
          "active_start_next": 0,
          "active_layers_next": 6,
          "ema_scores": [
            0.001680795593341525,
            0.001605290933330461,
            0.001545661561635228,
            0.0014767440871727364,
            0.001439521653068252,
            0.0013821112145034763
          ]
        },
        {
          "step": 10,
          "probe": true,
          "active_start_next": 0,
          "active_layers_next": 6,
          "ema_scores": [
            0.0017887410904829718,
            0.0017065699743879375,
            0.0016344291702199908,
            0.0015636448898248456,
            0.0015217308947953392,
            0.0014652627211776948
          ]
        },
        {
          "step": 12,
          "probe": true,
          "active_start_next": 0,
          "active_layers_next": 6,
          "ema_scores": [
            0.0018784635012032314,
            0.0017861380871252762,
            0.001708469296398177,
            0.001638323943234991,
            0.0015891411845484246,
            0.001528364801385557
          ]
        },
        {
          "step": 16,
          "probe": true,
          "active_start_next": 0,
          "active_layers_next": 6,
          "ema_scores": [
            0.001931285586145488,
            0.0018288099175087454,
            0.0017497781635625535,
            0.0016782399261067009,
            0.0016265265423604305,
            0.0015630033206947003
          ]
        }
      ]
    }
  }
}