{
  "script": "dynamic_block_update_schedule_bench.py",
  "timestamp_utc": "2026-02-25T19:16:56Z",
  "config": {
    "device_arg": "cpu",
    "resolved_device": "cpu",
    "dtype": "float32",
    "seed": 42,
    "dmodel": 128,
    "n_layers": 6,
    "hidden_mult": 2,
    "batch_size": 2,
    "seq_len": 64,
    "steps": 20,
    "equal_time_budget": false,
    "max_steps_multiplier": 3.0,
    "lr": 0.0003,
    "weight_decay": 0.0,
    "teacher_noise": 0.02,
    "val_batches": 2,
    "warmup_ignore_steps": 5,
    "static_active_layers": 2,
    "dyn_warmup_steps": 5,
    "dyn_probe_every": 4,
    "dyn_refresh_every": 10,
    "dyn_relevance_threshold": 0.7,
    "dyn_min_active_layers": 2,
    "dyn_max_active_layers": 3,
    "dyn_adapt_budget": true,
    "dyn_loss_upper": 1.03,
    "dyn_loss_lower": 0.995,
    "dyn_budget_step_up": 2,
    "dyn_budget_step_down": 1,
    "dyn_ema_decay": 0.9,
    "dyn_eps": 1e-08
  },
  "system": {
    "cuda_available": false,
    "cuda_device_name": null,
    "torch_version": "2.9.1+cu128"
  },
  "results": [
    {
      "schedule": "full_update",
      "steps_executed": 20,
      "elapsed_ms": 140.60292800422758,
      "final_val_loss": 0.052646152675151825,
      "train_loss_start": 0.10606145113706589,
      "train_loss_end": 0.053634993731975555,
      "mean_step_ms": 4.096859600152432,
      "p50_step_ms": 3.9188880000438076,
      "p90_step_ms": 4.687396001827437,
      "speedup_vs_full": 1.0,
      "active_layers_mean": 6.0,
      "active_layers_min": 6,
      "active_layers_max": 6,
      "probe_step_count": 0,
      "notes": "full update"
    },
    {
      "schedule": "static_suffix",
      "steps_executed": 20,
      "elapsed_ms": 51.712520005821716,
      "final_val_loss": 0.06756794080138206,
      "train_loss_start": 0.10625993460416794,
      "train_loss_end": 0.07086169719696045,
      "mean_step_ms": 2.238235200638883,
      "p50_step_ms": 2.0646310003940016,
      "p90_step_ms": 2.793425002892036,
      "speedup_vs_full": 1.8303972696806048,
      "active_layers_mean": 2.0,
      "active_layers_min": 2,
      "active_layers_max": 2,
      "probe_step_count": 0,
      "notes": "static active suffix=2"
    },
    {
      "schedule": "dynamic_suffix",
      "steps_executed": 20,
      "elapsed_ms": 70.77356900845189,
      "final_val_loss": 0.057672394439578056,
      "train_loss_start": 0.10626213252544403,
      "train_loss_end": 0.05901775881648064,
      "mean_step_ms": 2.914076533731228,
      "p50_step_ms": 2.448840001306962,
      "p90_step_ms": 4.416510000737617,
      "speedup_vs_full": 1.405886068100878,
      "active_layers_mean": 4.35,
      "active_layers_min": 3,
      "active_layers_max": 6,
      "probe_step_count": 9,
      "notes": "dynamic relevance-guided active suffix + adaptive budget"
    }
  ],
  "traces": {
    "full_update": {
      "step_times_ms": [
        62.86833400008618,
        4.385421998449601,
        4.151795001234859,
        3.831596000964055,
        3.9128870012064,
        3.8699979995726608,
        3.948043002310442,
        6.230260998563608,
        3.9354799991997425,
        3.9555680014018435,
        3.975914998591179,
        3.740504998859251,
        4.0591709985164925,
        4.687396001827437,
        3.81640700288699,
        3.9188880000438076,
        3.911243999027647,
        3.842807000182802,
        3.801890001341235,
        3.7593209999613464
      ],
      "train_losses": [
        0.10606145113706589,
        0.0991494283080101,
        0.09141726791858673,
        0.08918788284063339,
        0.08779001235961914,
        0.08280280232429504,
        0.08058103919029236,
        0.07848659157752991,
        0.07538919895887375,
        0.07147415727376938,
        0.07082254439592361,
        0.06713829934597015,
        0.06655574589967728,
        0.06444848328828812,
        0.061610929667949677,
        0.060430992394685745,
        0.058125630021095276,
        0.055908653885126114,
        0.05596281588077545,
        0.053634993731975555
      ],
      "active_layers_hist": [
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6
      ],
      "dynamic_trace": []
    },
    "static_suffix": {
      "step_times_ms": [
        2.4797269979899283,
        2.1753979999630246,
        5.5718609983159695,
        5.892408997169696,
        2.0195970027998555,
        1.9812150021607522,
        2.021119998971699,
        2.976375999423908,
        1.9712460016307887,
        1.9370020017959177,
        2.571359000285156,
        2.793425002892036,
        2.258513999549905,
        2.2889600004418753,
        1.9240090005041566,
        2.6302090009266976,
        2.2626520003541373,
        2.0646310003940016,
        1.942292001331225,
        1.9505179989209864
      ],
      "train_losses": [
        0.10625993460416794,
        0.10120944678783417,
        0.09616844356060028,
        0.09540002793073654,
        0.0913451761007309,
        0.09114622324705124,
        0.08864918351173401,
        0.08723519742488861,
        0.085580974817276,
        0.08263339102268219,
        0.08105923980474472,
        0.07943080365657806,
        0.07921421527862549,
        0.07853875309228897,
        0.0768149122595787,
        0.07542339712381363,
        0.07469841092824936,
        0.07231032103300095,
        0.06979941576719284,
        0.07086169719696045
      ],
      "active_layers_hist": [
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2
      ],
      "dynamic_trace": []
    },
    "dynamic_suffix": {
      "step_times_ms": [
        6.131296002422459,
        5.010199998650933,
        4.59103600223898,
        4.757357000926277,
        6.572531998244813,
        2.7848780009662732,
        2.4441909990855493,
        2.448840001306962,
        5.28155700158095,
        2.7845679978781845,
        4.13784900229075,
        3.35328100118204,
        4.416510000737617,
        2.1762300020782277,
        1.9301299980725162,
        1.959264001925476,
        3.751296000700677,
        2.1991520006849896,
        2.1187019992794376,
        1.9246999981987756
      ],
      "train_losses": [
        0.10626213252544403,
        0.09825529903173447,
        0.09377781301736832,
        0.09344934672117233,
        0.08785293996334076,
        0.08541922271251678,
        0.08274172991514206,
        0.07983015477657318,
        0.07801292836666107,
        0.07756810635328293,
        0.07144664227962494,
        0.07094360888004303,
        0.07008681446313858,
        0.06631787866353989,
        0.06756623089313507,
        0.0634024515748024,
        0.06369294971227646,
        0.06237509846687317,
        0.060836900025606155,
        0.05901775881648064
      ],
      "active_layers_hist": [
        6,
        6,
        6,
        6,
        6,
        3,
        3,
        3,
        6,
        3,
        6,
        3,
        6,
        3,
        3,
        3,
        6,
        3,
        3,
        3
      ],
      "dynamic_trace": [
        {
          "step": 0,
          "probe": true,
          "probe_loss": 0.10626213252544403,
          "best_probe_loss": 0.10626213252544403,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0004521440157776376,
            0.0004386200181603729,
            0.0004351470810363251,
            0.00041398412506288545,
            0.00042335362399929956,
            0.00040233194438693207
          ]
        },
        {
          "step": 1,
          "probe": true,
          "probe_loss": 0.09825529903173447,
          "best_probe_loss": 0.09825529903173447,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0007806311786637333,
            0.0007627021235400875,
            0.0007439370101550561,
            0.000697297603348508,
            0.0007050255826111148,
            0.0006670876289957898
          ]
        },
        {
          "step": 2,
          "probe": true,
          "probe_loss": 0.09377781301736832,
          "best_probe_loss": 0.09377781301736832,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.001063410333618634,
            0.0010237576786764858,
            0.000996721180867982,
            0.0009386598077981609,
            0.0009348510430469303,
            0.0008903761709316985
          ]
        },
        {
          "step": 3,
          "probe": true,
          "probe_loss": 0.09344934672117233,
          "best_probe_loss": 0.09344934672117233,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0013274083494939463,
            0.0012806011104470663,
            0.0012390670518743771,
            0.0011772482687184913,
            0.0011545764632783211,
            0.0011076693484690912
          ]
        },
        {
          "step": 4,
          "probe": true,
          "probe_loss": 0.08785293996334076,
          "best_probe_loss": 0.08785293996334076,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0015318933210260893,
            0.0014729186824307228,
            0.0014242404724662038,
            0.0013500056752929876,
            0.001324451774676686,
            0.0012731034198067604
          ]
        },
        {
          "step": 8,
          "probe": true,
          "probe_loss": 0.07801292836666107,
          "best_probe_loss": 0.07801292836666107,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.001687713182675049,
            0.0016108021551288832,
            0.001550438231031638,
            0.001478646452901494,
            0.0014412452003468423,
            0.0013829071499924502
          ]
        },
        {
          "step": 10,
          "probe": true,
          "probe_loss": 0.07144664227962494,
          "best_probe_loss": 0.07144664227962494,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0018097595615875223,
            0.0017255075666851535,
            0.0016519442400758427,
            0.0015758151100874365,
            0.0015327857553594853,
            0.0014744401833103778
          ]
        },
        {
          "step": 12,
          "probe": true,
          "probe_loss": 0.07008681446313858,
          "best_probe_loss": 0.07008681446313858,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0019177219317549584,
            0.0018242651156022687,
            0.0017436676161833237,
            0.0016663550546939796,
            0.0016146038775578379,
            0.0015502626885734823
          ]
        },
        {
          "step": 16,
          "probe": true,
          "probe_loss": 0.06369294971227646,
          "best_probe_loss": 0.06369294971227646,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.001984324160522258,
            0.0018813773246540893,
            0.0017979948128409413,
            0.0017177403394008064,
            0.001662465936833971,
            0.0015946327938157192
          ]
        }
      ]
    }
  }
}