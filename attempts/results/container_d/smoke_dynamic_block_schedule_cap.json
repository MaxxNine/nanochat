{
  "script": "dynamic_block_update_schedule_bench.py",
  "timestamp_utc": "2026-02-25T19:04:46Z",
  "config": {
    "device_arg": "cpu",
    "resolved_device": "cpu",
    "dtype": "float32",
    "seed": 42,
    "dmodel": 128,
    "n_layers": 6,
    "hidden_mult": 2,
    "batch_size": 2,
    "seq_len": 64,
    "steps": 20,
    "lr": 0.0003,
    "weight_decay": 0.0,
    "teacher_noise": 0.02,
    "val_batches": 2,
    "warmup_ignore_steps": 5,
    "static_active_layers": 2,
    "dyn_warmup_steps": 5,
    "dyn_probe_every": 4,
    "dyn_refresh_every": 10,
    "dyn_relevance_threshold": 0.7,
    "dyn_min_active_layers": 2,
    "dyn_max_active_layers": 3,
    "dyn_ema_decay": 0.9,
    "dyn_eps": 1e-08
  },
  "system": {
    "cuda_available": false,
    "cuda_device_name": null,
    "torch_version": "2.9.1+cu128"
  },
  "results": [
    {
      "schedule": "full_update",
      "final_val_loss": 0.052646152675151825,
      "train_loss_start": 0.10606145113706589,
      "train_loss_end": 0.053634993731975555,
      "mean_step_ms": 2.774465800393955,
      "p50_step_ms": 2.726924001763109,
      "p90_step_ms": 2.931265000370331,
      "speedup_vs_full": 1.0,
      "active_layers_mean": 6.0,
      "active_layers_min": 6,
      "active_layers_max": 6,
      "probe_step_count": 0,
      "notes": "full update"
    },
    {
      "schedule": "static_suffix",
      "final_val_loss": 0.06756794080138206,
      "train_loss_start": 0.10625993460416794,
      "train_loss_end": 0.07086169719696045,
      "mean_step_ms": 1.4034275331747874,
      "p50_step_ms": 1.3909490007790737,
      "p90_step_ms": 1.4563910008291714,
      "speedup_vs_full": 1.9769213121518643,
      "active_layers_mean": 2.0,
      "active_layers_min": 2,
      "active_layers_max": 2,
      "probe_step_count": 0,
      "notes": "static active suffix=2"
    },
    {
      "schedule": "dynamic_suffix",
      "final_val_loss": 0.057672394439578056,
      "train_loss_start": 0.10626213252544403,
      "train_loss_end": 0.05901775881648064,
      "mean_step_ms": 2.121156733604342,
      "p50_step_ms": 1.8075160005537327,
      "p90_step_ms": 2.9765500003122725,
      "speedup_vs_full": 1.3079966022498901,
      "active_layers_mean": 4.35,
      "active_layers_min": 3,
      "active_layers_max": 6,
      "probe_step_count": 9,
      "notes": "dynamic relevance-guided active suffix"
    }
  ],
  "traces": {
    "full_update": {
      "step_times_ms": [
        7.495720001315931,
        3.3747039997251704,
        2.885891000914853,
        2.805179999995744,
        2.7974360000371234,
        2.7543950000108453,
        2.7228049984842073,
        2.701245999560342,
        2.708309000809095,
        2.7920160009671235,
        2.8554740001709433,
        2.773000000161119,
        2.931265000370331,
        2.711123999688425,
        2.696166000532685,
        2.7255309996689903,
        2.6963770014845068,
        2.726924001763109,
        2.833202001056634,
        2.9891530011809664
      ],
      "train_losses": [
        0.10606145113706589,
        0.0991494283080101,
        0.09141726791858673,
        0.08918788284063339,
        0.08779001235961914,
        0.08280280232429504,
        0.08058103919029236,
        0.07848659157752991,
        0.07538919895887375,
        0.07147415727376938,
        0.07082254439592361,
        0.06713829934597015,
        0.06655574589967728,
        0.06444848328828812,
        0.061610929667949677,
        0.060430992394685745,
        0.058125630021095276,
        0.055908653885126114,
        0.05596281588077545,
        0.053634993731975555
      ],
      "active_layers_hist": [
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6
      ],
      "dynamic_trace": []
    },
    "static_suffix": {
      "step_times_ms": [
        1.5017850000731414,
        1.3991840005473932,
        1.4203230002749478,
        1.4447390003624605,
        1.3922710004408145,
        1.407638999808114,
        1.3933529990026727,
        1.4071890000195708,
        1.3838340000802418,
        1.3909490007790737,
        1.3801079985569231,
        1.3677749993803445,
        1.380818999678013,
        1.4563910008291714,
        1.5259099982358748,
        1.4291389998106752,
        1.4000450009916676,
        1.3879830003133975,
        1.3747379998676479,
        1.365541000268422
      ],
      "train_losses": [
        0.10625993460416794,
        0.10120944678783417,
        0.09616844356060028,
        0.09540002793073654,
        0.0913451761007309,
        0.09114622324705124,
        0.08864918351173401,
        0.08723519742488861,
        0.085580974817276,
        0.08263339102268219,
        0.08105923980474472,
        0.07943080365657806,
        0.07921421527862549,
        0.07853875309228897,
        0.0768149122595787,
        0.07542339712381363,
        0.07469841092824936,
        0.07231032103300095,
        0.06979941576719284,
        0.07086169719696045
      ],
      "active_layers_hist": [
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2
      ],
      "dynamic_trace": []
    },
    "dynamic_suffix": {
      "step_times_ms": [
        4.8101949996635085,
        3.6773289994016523,
        3.0642940000689123,
        3.0836690002615796,
        3.533660999892163,
        1.8188180001743603,
        1.774624999598018,
        1.8075160005537327,
        2.9417450004984858,
        1.756870999088278,
        2.9765500003122725,
        1.7863960001704982,
        2.9177100004744716,
        1.8096900003001792,
        1.7558100007590838,
        1.8222740000055637,
        3.326142999867443,
        1.8035590001090895,
        1.7494870007794816,
        1.770157001374173
      ],
      "train_losses": [
        0.10626213252544403,
        0.09825529903173447,
        0.09377781301736832,
        0.09344934672117233,
        0.08785293996334076,
        0.08541922271251678,
        0.08274172991514206,
        0.07983015477657318,
        0.07801292836666107,
        0.07756810635328293,
        0.07144664227962494,
        0.07094360888004303,
        0.07008681446313858,
        0.06631787866353989,
        0.06756623089313507,
        0.0634024515748024,
        0.06369294971227646,
        0.06237509846687317,
        0.060836900025606155,
        0.05901775881648064
      ],
      "active_layers_hist": [
        6,
        6,
        6,
        6,
        6,
        3,
        3,
        3,
        6,
        3,
        6,
        3,
        6,
        3,
        3,
        3,
        6,
        3,
        3,
        3
      ],
      "dynamic_trace": [
        {
          "step": 0,
          "probe": true,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0004521440157776376,
            0.0004386200181603729,
            0.0004351470810363251,
            0.00041398412506288545,
            0.00042335362399929956,
            0.00040233194438693207
          ]
        },
        {
          "step": 1,
          "probe": true,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0007806311786637333,
            0.0007627021235400875,
            0.0007439370101550561,
            0.000697297603348508,
            0.0007050255826111148,
            0.0006670876289957898
          ]
        },
        {
          "step": 2,
          "probe": true,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.001063410333618634,
            0.0010237576786764858,
            0.000996721180867982,
            0.0009386598077981609,
            0.0009348510430469303,
            0.0008903761709316985
          ]
        },
        {
          "step": 3,
          "probe": true,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0013274083494939463,
            0.0012806011104470663,
            0.0012390670518743771,
            0.0011772482687184913,
            0.0011545764632783211,
            0.0011076693484690912
          ]
        },
        {
          "step": 4,
          "probe": true,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0015318933210260893,
            0.0014729186824307228,
            0.0014242404724662038,
            0.0013500056752929876,
            0.001324451774676686,
            0.0012731034198067604
          ]
        },
        {
          "step": 8,
          "probe": true,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.001687713182675049,
            0.0016108021551288832,
            0.001550438231031638,
            0.001478646452901494,
            0.0014412452003468423,
            0.0013829071499924502
          ]
        },
        {
          "step": 10,
          "probe": true,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0018097595615875223,
            0.0017255075666851535,
            0.0016519442400758427,
            0.0015758151100874365,
            0.0015327857553594853,
            0.0014744401833103778
          ]
        },
        {
          "step": 12,
          "probe": true,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0019177219317549584,
            0.0018242651156022687,
            0.0017436676161833237,
            0.0016663550546939796,
            0.0016146038775578379,
            0.0015502626885734823
          ]
        },
        {
          "step": 16,
          "probe": true,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.001984324160522258,
            0.0018813773246540893,
            0.0017979948128409413,
            0.0017177403394008064,
            0.001662465936833971,
            0.0015946327938157192
          ]
        }
      ]
    }
  }
}