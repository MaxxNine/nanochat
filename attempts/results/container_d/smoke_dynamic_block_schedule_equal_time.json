{
  "script": "dynamic_block_update_schedule_bench.py",
  "timestamp_utc": "2026-02-25T19:16:56Z",
  "config": {
    "device_arg": "cpu",
    "resolved_device": "cpu",
    "dtype": "float32",
    "seed": 42,
    "dmodel": 128,
    "n_layers": 6,
    "hidden_mult": 2,
    "batch_size": 2,
    "seq_len": 64,
    "steps": 20,
    "equal_time_budget": true,
    "max_steps_multiplier": 2.0,
    "lr": 0.0003,
    "weight_decay": 0.0,
    "teacher_noise": 0.02,
    "val_batches": 2,
    "warmup_ignore_steps": 5,
    "static_active_layers": 2,
    "dyn_warmup_steps": 5,
    "dyn_probe_every": 4,
    "dyn_refresh_every": 10,
    "dyn_relevance_threshold": 0.7,
    "dyn_min_active_layers": 2,
    "dyn_max_active_layers": 3,
    "dyn_adapt_budget": true,
    "dyn_loss_upper": 1.03,
    "dyn_loss_lower": 0.995,
    "dyn_budget_step_up": 2,
    "dyn_budget_step_down": 1,
    "dyn_ema_decay": 0.9,
    "dyn_eps": 1e-08
  },
  "system": {
    "cuda_available": false,
    "cuda_device_name": null,
    "torch_version": "2.9.1+cu128"
  },
  "results": [
    {
      "schedule": "full_update",
      "steps_executed": 20,
      "elapsed_ms": 74.41234499128768,
      "final_val_loss": 0.052646152675151825,
      "train_loss_start": 0.10606145113706589,
      "train_loss_end": 0.053634993731975555,
      "mean_step_ms": 3.2757261993538123,
      "p50_step_ms": 3.2915859992499463,
      "p90_step_ms": 3.384900999662932,
      "speedup_vs_full": 1.0,
      "active_layers_mean": 6.0,
      "active_layers_min": 6,
      "active_layers_max": 6,
      "probe_step_count": 0,
      "notes": "full update"
    },
    {
      "schedule": "static_suffix",
      "steps_executed": 40,
      "elapsed_ms": 72.19750999865937,
      "final_val_loss": 0.05145811289548874,
      "train_loss_start": 0.10625993460416794,
      "train_loss_end": 0.05095205456018448,
      "mean_step_ms": 1.8079666284653026,
      "p50_step_ms": 1.729334002448013,
      "p90_step_ms": 1.9072270006290637,
      "speedup_vs_full": 1.8118289064518969,
      "active_layers_mean": 2.0,
      "active_layers_min": 2,
      "active_layers_max": 2,
      "probe_step_count": 0,
      "notes": "static active suffix=2"
    },
    {
      "schedule": "dynamic_suffix",
      "steps_executed": 25,
      "elapsed_ms": 79.47337799123488,
      "final_val_loss": 0.05225775018334389,
      "train_loss_start": 0.10321581363677979,
      "train_loss_end": 0.05325474590063095,
      "mean_step_ms": 2.8741124497173587,
      "p50_step_ms": 2.2759469975426327,
      "p90_step_ms": 4.147395997279091,
      "speedup_vs_full": 1.139734876996879,
      "active_layers_mean": 4.32,
      "active_layers_min": 3,
      "active_layers_max": 6,
      "probe_step_count": 11,
      "notes": "dynamic relevance-guided active suffix + adaptive budget"
    }
  ],
  "traces": {
    "full_update": {
      "step_times_ms": [
        11.978823000390548,
        3.504473999782931,
        3.273641999840038,
        3.316542999527883,
        3.2029700014390983,
        3.401941998163238,
        3.2960039970930666,
        3.1764300001668744,
        3.2070879969978705,
        3.2131790030689444,
        3.1862890027696267,
        3.2101839969982393,
        3.145792998111574,
        3.214160999050364,
        3.2915859992499463,
        3.369721998751629,
        3.384900999662932,
        3.355005002958933,
        3.3299069982604124,
        3.3537019990035333
      ],
      "train_losses": [
        0.10606145113706589,
        0.0991494283080101,
        0.09141726791858673,
        0.08918788284063339,
        0.08779001235961914,
        0.08280280232429504,
        0.08058103919029236,
        0.07848659157752991,
        0.07538919895887375,
        0.07147415727376938,
        0.07082254439592361,
        0.06713829934597015,
        0.06655574589967728,
        0.06444848328828812,
        0.061610929667949677,
        0.060430992394685745,
        0.058125630021095276,
        0.055908653885126114,
        0.05596281588077545,
        0.053634993731975555
      ],
      "active_layers_hist": [
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6
      ],
      "dynamic_trace": []
    },
    "static_suffix": {
      "step_times_ms": [
        1.9566390001273248,
        1.822949001507368,
        1.7011710006045178,
        1.7290229989157524,
        1.7088960012188181,
        1.713363999442663,
        1.7347239991067909,
        1.7471280007157475,
        1.756945999659365,
        1.7498429988336284,
        1.9072270006290637,
        1.7270799980906304,
        1.7654409966780804,
        1.7429300023650285,
        1.7624159991100896,
        1.7051989998435602,
        1.672337999480078,
        1.7811910001910292,
        1.741586998832645,
        1.7112909990828484,
        1.7390619977959432,
        1.728503000776982,
        1.729334002448013,
        1.7279009989579208,
        1.7541810011607595,
        1.7423979988961946,
        1.6935269995883573,
        1.7143260010925587,
        1.6433529999630991,
        1.7251969984499738,
        1.7043870029738173,
        1.705700000457,
        1.6723180015105754,
        2.0390130011946894,
        1.9211030012229457,
        3.8388289976865053,
        1.8282689998159185,
        1.7219299988937564,
        1.7251259996555746,
        1.7056700016837567
      ],
      "train_losses": [
        0.10625993460416794,
        0.10120944678783417,
        0.09616844356060028,
        0.09540002793073654,
        0.0913451761007309,
        0.09114622324705124,
        0.08864918351173401,
        0.08723519742488861,
        0.085580974817276,
        0.08263339102268219,
        0.08105923980474472,
        0.07943080365657806,
        0.07921421527862549,
        0.07853875309228897,
        0.0768149122595787,
        0.07542339712381363,
        0.07469841092824936,
        0.07231032103300095,
        0.06979941576719284,
        0.07086169719696045,
        0.06979253143072128,
        0.06770335882902145,
        0.0657254010438919,
        0.06500130891799927,
        0.06256147474050522,
        0.06427168101072311,
        0.060465846210718155,
        0.061132825911045074,
        0.0597047433257103,
        0.05979664623737335,
        0.05844183638691902,
        0.06084214150905609,
        0.057025179266929626,
        0.056307028979063034,
        0.05545995011925697,
        0.05559986084699631,
        0.05318190157413483,
        0.05384516716003418,
        0.053493596613407135,
        0.05095205456018448
      ],
      "active_layers_hist": [
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2
      ],
      "dynamic_trace": []
    },
    "dynamic_suffix": {
      "step_times_ms": [
        5.347951999283396,
        4.55078100276296,
        3.8406129970098846,
        4.143268997722771,
        4.108514000108698,
        2.2614289991906844,
        2.1839149994775653,
        3.201275998435449,
        3.6344469990581274,
        2.188613001635531,
        3.7332319989218377,
        2.314367997314548,
        4.147395997279091,
        2.2693639984936453,
        2.149530002498068,
        3.2456299995828886,
        3.676975997223053,
        2.215794000221649,
        2.1178700008022133,
        2.1755279994977172,
        4.185608002444496,
        2.2759469975426327,
        2.171871001337422,
        2.1296830018400215,
        5.203772001550533
      ],
      "train_losses": [
        0.10321581363677979,
        0.09891904890537262,
        0.09223386645317078,
        0.09084061533212662,
        0.0872407928109169,
        0.08403801172971725,
        0.08322078734636307,
        0.08063190430402756,
        0.07637512683868408,
        0.07575871050357819,
        0.07090363651514053,
        0.07076483964920044,
        0.06791964173316956,
        0.06730975955724716,
        0.06512108445167542,
        0.06309857219457626,
        0.06186910718679428,
        0.06142779067158699,
        0.060309793800115585,
        0.059067633002996445,
        0.05734869837760925,
        0.05749642476439476,
        0.05578505992889404,
        0.05454118922352791,
        0.05325474590063095
      ],
      "active_layers_hist": [
        6,
        6,
        6,
        6,
        6,
        3,
        3,
        3,
        6,
        3,
        6,
        3,
        6,
        3,
        3,
        3,
        6,
        3,
        3,
        3,
        6,
        3,
        3,
        3,
        6
      ],
      "dynamic_trace": [
        {
          "step": 0,
          "probe": true,
          "probe_loss": 0.10321581363677979,
          "best_probe_loss": 0.10321581363677979,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0004283553974225147,
            0.00042162158131086555,
            0.00040207223409191887,
            0.00038743955145400453,
            0.00037490999087206564,
            0.0003680440206719712
          ]
        },
        {
          "step": 1,
          "probe": true,
          "probe_loss": 0.09891904890537262,
          "best_probe_loss": 0.09891904890537262,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0007591944182475073,
            0.0007322106135286309,
            0.0007005644015259695,
            0.0006674411517840143,
            0.000655238571640914,
            0.0006368929727328296
          ]
        },
        {
          "step": 2,
          "probe": true,
          "probe_loss": 0.09223386645317078,
          "best_probe_loss": 0.09223386645317078,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0010389121496199877,
            0.000999533312147811,
            0.0009425767652665961,
            0.000899501587258119,
            0.0008847244836056253,
            0.0008532679745867401
          ]
        },
        {
          "step": 3,
          "probe": true,
          "probe_loss": 0.09084061533212662,
          "best_probe_loss": 0.09084061533212662,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0012792216027876497,
            0.0012307799531193792,
            0.0011651779537496577,
            0.001118405864735886,
            0.0010902459025791602,
            0.001051582404742877
          ]
        },
        {
          "step": 4,
          "probe": true,
          "probe_loss": 0.0872407928109169,
          "best_probe_loss": 0.0872407928109169,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0014949299693658607,
            0.0014332541424398966,
            0.0013622179510730452,
            0.0013079702237003752,
            0.0012754843019322573,
            0.00122776474868962
          ]
        },
        {
          "step": 8,
          "probe": true,
          "probe_loss": 0.07637512683868408,
          "best_probe_loss": 0.07637512683868408,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0016399169123321037,
            0.0015669164545649417,
            0.0014895734337121195,
            0.0014296600953107124,
            0.001392537344982026,
            0.0013324080125833868
          ]
        },
        {
          "step": 10,
          "probe": true,
          "probe_loss": 0.07090363651514053,
          "best_probe_loss": 0.07090363651514053,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0017531664287702155,
            0.0016720994512419984,
            0.0015903275184594222,
            0.0015199367926255123,
            0.0014812804745947693,
            0.0014166789372490822
          ]
        },
        {
          "step": 12,
          "probe": true,
          "probe_loss": 0.06791964173316956,
          "best_probe_loss": 0.06791964173316956,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0018463009771333121,
            0.001763647692088623,
            0.0016737468609402707,
            0.001598319367807095,
            0.0015625119025470546,
            0.0014881846890125118
          ]
        },
        {
          "step": 16,
          "probe": true,
          "probe_loss": 0.06186910718679428,
          "best_probe_loss": 0.06186910718679428,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0019215649801846894,
            0.0018329982533757925,
            0.0017402051565323505,
            0.001659530064185912,
            0.0016127111752941826,
            0.0015336068470342685
          ]
        },
        {
          "step": 20,
          "probe": true,
          "probe_loss": 0.05734869837760925,
          "best_probe_loss": 0.05734869837760925,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.001971812876402801,
            0.0018773488441925226,
            0.0017833367046510363,
            0.0016982461856219996,
            0.0016467846358323346,
            0.0015657361992986955
          ]
        },
        {
          "step": 24,
          "probe": true,
          "probe_loss": 0.05325474590063095,
          "best_probe_loss": 0.05325474590063095,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0020092672523166813,
            0.0019086461413643846,
            0.0018082481578174951,
            0.001715011554842181,
            0.0016639718341899328,
            0.0015774015585036632
          ]
        }
      ]
    }
  }
}