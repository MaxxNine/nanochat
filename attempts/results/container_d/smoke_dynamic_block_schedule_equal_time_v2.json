{
  "script": "dynamic_block_update_schedule_bench.py",
  "timestamp_utc": "2026-02-25T19:25:26Z",
  "config": {
    "device_arg": "cpu",
    "resolved_device": "cpu",
    "dtype": "float32",
    "seed": 42,
    "dmodel": 128,
    "n_layers": 6,
    "hidden_mult": 2,
    "batch_size": 2,
    "seq_len": 64,
    "steps": 20,
    "equal_time_budget": true,
    "max_steps_multiplier": 2.0,
    "lr": 0.0003,
    "weight_decay": 0.0,
    "teacher_noise": 0.02,
    "val_batches": 2,
    "warmup_ignore_steps": 5,
    "static_active_layers": 2,
    "dyn_warmup_steps": 5,
    "dyn_probe_every": 4,
    "dyn_refresh_every": 10,
    "dyn_relevance_threshold": 0.7,
    "dyn_min_active_layers": 2,
    "dyn_max_active_layers": 3,
    "dyn_adapt_budget": true,
    "dyn_loss_upper": 1.03,
    "dyn_loss_lower": 0.995,
    "dyn_budget_step_up": 2,
    "dyn_budget_step_down": 1,
    "dyn_ema_decay": 0.9,
    "dyn_eps": 1e-08
  },
  "system": {
    "cuda_available": false,
    "cuda_device_name": null,
    "torch_version": "2.9.1+cu128"
  },
  "results": [
    {
      "schedule": "full_update",
      "steps_executed": 20,
      "elapsed_ms": 61.90680699728546,
      "final_val_loss": 0.052646152675151825,
      "train_loss_start": 0.10606145113706589,
      "train_loss_end": 0.053634993731975555,
      "mean_step_ms": 2.8405498662323225,
      "p50_step_ms": 2.8252209995116573,
      "p90_step_ms": 2.876515998650575,
      "speedup_vs_full": 1.0,
      "active_layers_mean": 6.0,
      "active_layers_min": 6,
      "active_layers_max": 6,
      "probe_step_count": 0,
      "notes": "full update"
    },
    {
      "schedule": "static_suffix",
      "steps_executed": 39,
      "elapsed_ms": 61.92937899322715,
      "final_val_loss": 0.052026236429810524,
      "train_loss_start": 0.10625993460416794,
      "train_loss_end": 0.053493596613407135,
      "mean_step_ms": 1.516263970402446,
      "p50_step_ms": 1.493891999416519,
      "p90_step_ms": 1.5796519983268809,
      "speedup_vs_full": 1.8733874323204982,
      "active_layers_mean": 2.0,
      "active_layers_min": 2,
      "active_layers_max": 2,
      "probe_step_count": 0,
      "notes": "static active suffix=2"
    },
    {
      "schedule": "dynamic_suffix",
      "steps_executed": 25,
      "elapsed_ms": 63.23914600216085,
      "final_val_loss": 0.052201731130480766,
      "train_loss_start": 0.10419896245002747,
      "train_loss_end": 0.05351869389414787,
      "mean_step_ms": 2.2675095498925657,
      "p50_step_ms": 1.917893998324871,
      "p90_step_ms": 3.099604000453837,
      "speedup_vs_full": 1.252717928516291,
      "active_layers_mean": 4.32,
      "active_layers_min": 3,
      "active_layers_max": 6,
      "probe_step_count": 11,
      "notes": "dynamic relevance-guided active suffix + adaptive budget"
    }
  ],
  "traces": {
    "full_update": {
      "step_times_ms": [
        7.331782999244751,
        3.108990000328049,
        3.0862880012136884,
        2.958680001029279,
        2.8128180019848514,
        2.8667279984802008,
        2.805935000651516,
        2.826292002282571,
        2.876515998650575,
        2.8252209995116573,
        2.7812189982796554,
        3.0401820004044566,
        2.8219640007591806,
        2.8394270011631306,
        2.83509899963974,
        2.7854859981744085,
        2.8587640008481685,
        2.8210229975229595,
        2.8007839973724913,
        2.8236079997441266
      ],
      "train_losses": [
        0.10606145113706589,
        0.0991494283080101,
        0.09141726791858673,
        0.08918788284063339,
        0.08779001235961914,
        0.08280280232429504,
        0.08058103919029236,
        0.07848659157752991,
        0.07538919895887375,
        0.07147415727376938,
        0.07082254439592361,
        0.06713829934597015,
        0.06655574589967728,
        0.06444848328828812,
        0.061610929667949677,
        0.060430992394685745,
        0.058125630021095276,
        0.055908653885126114,
        0.05596281588077545,
        0.053634993731975555
      ],
      "active_layers_hist": [
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6
      ],
      "dynamic_trace": []
    },
    "static_suffix": {
      "step_times_ms": [
        1.7777930006559473,
        1.5945710001687985,
        3.0809380004939158,
        1.7278289997193497,
        2.1952729985059705,
        1.6592510000918992,
        1.5794729988556355,
        1.5044319989101496,
        1.469186998292571,
        1.493891999416519,
        1.4880710004945286,
        1.727208000374958,
        1.5992689986887854,
        1.4984709996497259,
        1.5031889997771941,
        1.4777319993299898,
        1.4532259992847685,
        1.4848050013824832,
        1.5413809996971395,
        1.5320729980885517,
        1.4763690014660824,
        1.4740660008101258,
        1.545930001157103,
        1.4833429995633196,
        1.5472819977730978,
        1.5422620017488953,
        1.483443000324769,
        1.5390260014100932,
        1.4627139971707948,
        1.4545090016326867,
        1.490646001911955,
        1.5796519983268809,
        1.4515330003632698,
        1.5706550002505537,
        1.5028189991426188,
        1.4661899986094795,
        1.4691659998788964,
        1.516344000265235,
        1.4853659995424096
      ],
      "train_losses": [
        0.10625993460416794,
        0.10120944678783417,
        0.09616844356060028,
        0.09540002793073654,
        0.0913451761007309,
        0.09114622324705124,
        0.08864918351173401,
        0.08723519742488861,
        0.085580974817276,
        0.08263339102268219,
        0.08105923980474472,
        0.07943080365657806,
        0.07921421527862549,
        0.07853875309228897,
        0.0768149122595787,
        0.07542339712381363,
        0.07469841092824936,
        0.07231032103300095,
        0.06979941576719284,
        0.07086169719696045,
        0.06979253143072128,
        0.06770335882902145,
        0.0657254010438919,
        0.06500130891799927,
        0.06256147474050522,
        0.06427168101072311,
        0.060465846210718155,
        0.061132825911045074,
        0.0597047433257103,
        0.05979664623737335,
        0.05844183638691902,
        0.06084214150905609,
        0.057025179266929626,
        0.056307028979063034,
        0.05545995011925697,
        0.05559986084699631,
        0.05318190157413483,
        0.05384516716003418,
        0.053493596613407135
      ],
      "active_layers_hist": [
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2
      ],
      "dynamic_trace": []
    },
    "dynamic_suffix": {
      "step_times_ms": [
        4.662144001486013,
        3.6401540019141976,
        3.1207130014081486,
        3.2541010004933923,
        3.2118429990077857,
        1.8725299996731337,
        1.917893998324871,
        1.8200010017608292,
        3.086497999902349,
        1.9027660018764436,
        3.314103996672202,
        1.989808999496745,
        3.0842249980196357,
        1.8920960028481204,
        1.9042189996980596,
        1.8811459995049518,
        3.099604000453837,
        1.8938899993372615,
        1.837896001234185,
        1.8747840003925376,
        3.0865989974699914,
        1.9539320019248407,
        1.9744899982470088,
        1.8416620005154982,
        3.1220460004988126
      ],
      "train_losses": [
        0.10419896245002747,
        0.09605275839567184,
        0.09452994912862778,
        0.08895908296108246,
        0.08769893646240234,
        0.08407123386859894,
        0.08191843330860138,
        0.08124103397130966,
        0.0786910280585289,
        0.07373939454555511,
        0.07402099668979645,
        0.06862136721611023,
        0.06915163993835449,
        0.06582179665565491,
        0.06597795337438583,
        0.06378281116485596,
        0.06202191859483719,
        0.06007733196020126,
        0.06037250533699989,
        0.05923256278038025,
        0.05776648595929146,
        0.055774345993995667,
        0.056422337889671326,
        0.05474420636892319,
        0.05351869389414787
      ],
      "active_layers_hist": [
        6,
        6,
        6,
        6,
        6,
        3,
        3,
        3,
        6,
        3,
        6,
        3,
        6,
        3,
        3,
        3,
        6,
        3,
        3,
        3,
        6,
        3,
        3,
        3,
        6
      ],
      "dynamic_trace": [
        {
          "step": 0,
          "probe": true,
          "probe_loss": 0.10419896245002747,
          "best_probe_loss": 0.10419896245002747,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0004336894806042453,
            0.0004132676395554967,
            0.00039796647302582134,
            0.0003880608964533933,
            0.0003807485171830695,
            0.0003815199205865093
          ]
        },
        {
          "step": 1,
          "probe": true,
          "probe_loss": 0.09605275839567184,
          "best_probe_loss": 0.09605275839567184,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0007406300956280431,
            0.0007181361713134551,
            0.0006826382598763114,
            0.0006602965669262213,
            0.0006401648026835042,
            0.0006301459270783562
          ]
        },
        {
          "step": 2,
          "probe": true,
          "probe_loss": 0.09452994912862778,
          "best_probe_loss": 0.09452994912862778,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0010292906495891535,
            0.0009908931099895633,
            0.0009397433230989971,
            0.0009027204120980794,
            0.0008821147393215125,
            0.0008625596619692583
          ]
        },
        {
          "step": 3,
          "probe": true,
          "probe_loss": 0.08895908296108246,
          "best_probe_loss": 0.08895908296108246,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.001280498361873324,
            0.0012331329740870988,
            0.0011579789711118984,
            0.0011116826551390677,
            0.0010896263614428438,
            0.0010569961997257777
          ]
        },
        {
          "step": 4,
          "probe": true,
          "probe_loss": 0.08769893646240234,
          "best_probe_loss": 0.08769893646240234,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0014860581309862856,
            0.0014317300033366526,
            0.0013481571098346076,
            0.001297656045294802,
            0.0012635797119711605,
            0.0012236390171433656
          ]
        },
        {
          "step": 8,
          "probe": true,
          "probe_loss": 0.0786910280585289,
          "best_probe_loss": 0.0786910280585289,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0016448692433816022,
            0.0015828870081241505,
            0.0014966518697160152,
            0.001429002462994863,
            0.001388302210689662,
            0.0013413546592057272
          ]
        },
        {
          "step": 10,
          "probe": true,
          "probe_loss": 0.07402099668979645,
          "best_probe_loss": 0.07402099668979645,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0017754933567955054,
            0.001697944488991996,
            0.001613828035578144,
            0.0015352671426547197,
            0.001489751178849032,
            0.0014339485637615227
          ]
        },
        {
          "step": 12,
          "probe": true,
          "probe_loss": 0.06915163993835449,
          "best_probe_loss": 0.06915163993835449,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0018820429748434824,
            0.0017831171570704192,
            0.0016984144494302956,
            0.0016133309550077865,
            0.0015678907737947385,
            0.0015106687481715073
          ]
        },
        {
          "step": 16,
          "probe": true,
          "probe_loss": 0.06202191859483719,
          "best_probe_loss": 0.06202191859483719,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0019521356062795177,
            0.001854116903872971,
            0.0017551529530447614,
            0.0016603951794237743,
            0.0016178346889093207,
            0.0015536571807036957
          ]
        },
        {
          "step": 20,
          "probe": true,
          "probe_loss": 0.05776648595929146,
          "best_probe_loss": 0.05776648595929146,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.001999350278902041,
            0.0018927247969995756,
            0.0017914141467163683,
            0.0016956225272714736,
            0.0016441589428211835,
            0.001579192812523357
          ]
        },
        {
          "step": 24,
          "probe": true,
          "probe_loss": 0.05351869389414787,
          "best_probe_loss": 0.05351869389414787,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.002038188340185921,
            0.0019301869394351022,
            0.0018249419492319154,
            0.0017189258101721315,
            0.0016651631056725624,
            0.001594277643072294
          ]
        }
      ]
    }
  }
}