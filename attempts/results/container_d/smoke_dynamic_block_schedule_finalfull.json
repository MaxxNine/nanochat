{
  "script": "dynamic_block_update_schedule_bench.py",
  "timestamp_utc": "2026-02-25T19:26:58Z",
  "config": {
    "device_arg": "cpu",
    "resolved_device": "cpu",
    "dtype": "float32",
    "seed": 42,
    "dmodel": 128,
    "n_layers": 6,
    "hidden_mult": 2,
    "batch_size": 2,
    "seq_len": 64,
    "steps": 20,
    "equal_time_budget": true,
    "max_steps_multiplier": 2.0,
    "lr": 0.0003,
    "weight_decay": 0.0,
    "teacher_noise": 0.02,
    "val_batches": 2,
    "warmup_ignore_steps": 5,
    "static_active_layers": 2,
    "dyn_warmup_steps": 4,
    "dyn_probe_every": 5,
    "dyn_refresh_every": 20,
    "dyn_relevance_threshold": 0.8,
    "dyn_min_active_layers": 2,
    "dyn_max_active_layers": 4,
    "dyn_adapt_budget": true,
    "dyn_final_full_frac": 0.25,
    "dyn_loss_upper": 1.03,
    "dyn_loss_lower": 0.995,
    "dyn_budget_step_up": 2,
    "dyn_budget_step_down": 1,
    "dyn_ema_decay": 0.9,
    "dyn_eps": 1e-08
  },
  "system": {
    "cuda_available": false,
    "cuda_device_name": null,
    "torch_version": "2.9.1+cu128"
  },
  "results": [
    {
      "schedule": "full_update",
      "steps_executed": 20,
      "elapsed_ms": 66.49260999256512,
      "final_val_loss": 0.052646152675151825,
      "train_loss_start": 0.10606145113706589,
      "train_loss_end": 0.053634993731975555,
      "mean_step_ms": 3.0161281327309553,
      "p50_step_ms": 3.0113379980321042,
      "p90_step_ms": 3.1664879970776383,
      "speedup_vs_full": 1.0,
      "active_layers_mean": 6.0,
      "active_layers_min": 6,
      "active_layers_max": 6,
      "probe_step_count": 0,
      "notes": "full update"
    },
    {
      "schedule": "static_suffix",
      "steps_executed": 40,
      "elapsed_ms": 60.70748300771811,
      "final_val_loss": 0.05145811289548874,
      "train_loss_start": 0.10625993460416794,
      "train_loss_end": 0.05095205456018448,
      "mean_step_ms": 1.5109499431023974,
      "p50_step_ms": 1.4954950020182878,
      "p90_step_ms": 1.586393998877611,
      "speedup_vs_full": 1.9961800498420295,
      "active_layers_mean": 2.0,
      "active_layers_min": 2,
      "active_layers_max": 2,
      "probe_step_count": 0,
      "notes": "static active suffix=2"
    },
    {
      "schedule": "dynamic_suffix",
      "steps_executed": 24,
      "elapsed_ms": 69.30908499271027,
      "final_val_loss": 0.05088117532432079,
      "train_loss_start": 0.10321581363677979,
      "train_loss_end": 0.05205496400594711,
      "mean_step_ms": 2.756092578860453,
      "p50_step_ms": 2.839646997017553,
      "p90_step_ms": 3.264170001784805,
      "speedup_vs_full": 1.0943493538152544,
      "active_layers_mean": 5.083333333333333,
      "active_layers_min": 4,
      "active_layers_max": 6,
      "probe_step_count": 7,
      "notes": "dynamic relevance-guided active suffix + adaptive budget + final_full_frac=0.25"
    }
  ],
  "traces": {
    "full_update": {
      "step_times_ms": [
        8.024627997656353,
        3.3091650002461392,
        3.324242999951821,
        3.1898420020297635,
        3.402810001716716,
        3.0809880008746404,
        3.130319997580955,
        3.0854870019538794,
        2.9472679998434614,
        2.964520997920772,
        3.1664879970776383,
        3.445098001975566,
        2.877117000025464,
        3.0426359990087803,
        3.0113379980321042,
        2.938551999250194,
        2.812645998346852,
        2.796206001221435,
        2.817646000039531,
        3.1256109978130553
      ],
      "train_losses": [
        0.10606145113706589,
        0.0991494283080101,
        0.09141726791858673,
        0.08918788284063339,
        0.08779001235961914,
        0.08280280232429504,
        0.08058103919029236,
        0.07848659157752991,
        0.07538919895887375,
        0.07147415727376938,
        0.07082254439592361,
        0.06713829934597015,
        0.06655574589967728,
        0.06444848328828812,
        0.061610929667949677,
        0.060430992394685745,
        0.058125630021095276,
        0.055908653885126114,
        0.05596281588077545,
        0.053634993731975555
      ],
      "active_layers_hist": [
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6
      ],
      "dynamic_trace": []
    },
    "static_suffix": {
      "step_times_ms": [
        1.596684000105597,
        1.5421729985973798,
        1.5956429997459054,
        1.4642870009993203,
        1.6254479996860027,
        1.5106239989108872,
        1.4759490004507825,
        1.4973389988881536,
        1.4720309991389513,
        1.4445199994952418,
        1.4627540003857575,
        1.5313120020437054,
        1.7464439988543745,
        1.4667619980173185,
        1.515122003183933,
        1.4321859998744912,
        1.4702789994771592,
        1.5800020009919535,
        1.4871800012770109,
        1.4834520006843377,
        1.5178070025285706,
        1.6055900014180224,
        1.5196499989542644,
        1.5211729987640865,
        1.442074997612508,
        1.6322910014423542,
        1.4795050010434352,
        1.566066999657778,
        1.5336759970523417,
        1.5405090016429313,
        1.586393998877611,
        1.4501200021186378,
        1.468645001295954,
        1.4475360003416426,
        1.458085000194842,
        1.4871700004732702,
        1.538425000035204,
        1.493922001827741,
        1.5231569996103644,
        1.4954950020182878
      ],
      "train_losses": [
        0.10625993460416794,
        0.10120944678783417,
        0.09616844356060028,
        0.09540002793073654,
        0.0913451761007309,
        0.09114622324705124,
        0.08864918351173401,
        0.08723519742488861,
        0.085580974817276,
        0.08263339102268219,
        0.08105923980474472,
        0.07943080365657806,
        0.07921421527862549,
        0.07853875309228897,
        0.0768149122595787,
        0.07542339712381363,
        0.07469841092824936,
        0.07231032103300095,
        0.06979941576719284,
        0.07086169719696045,
        0.06979253143072128,
        0.06770335882902145,
        0.0657254010438919,
        0.06500130891799927,
        0.06256147474050522,
        0.06427168101072311,
        0.060465846210718155,
        0.061132825911045074,
        0.0597047433257103,
        0.05979664623737335,
        0.05844183638691902,
        0.06084214150905609,
        0.057025179266929626,
        0.056307028979063034,
        0.05545995011925697,
        0.05559986084699631,
        0.05318190157413483,
        0.05384516716003418,
        0.053493596613407135,
        0.05095205456018448
      ],
      "active_layers_hist": [
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2
      ],
      "dynamic_trace": []
    },
    "dynamic_suffix": {
      "step_times_ms": [
        4.872105000686133,
        3.535506999469362,
        3.17362199712079,
        3.123256999970181,
        2.238834997115191,
        3.2422499971289653,
        2.4154740021913312,
        2.2576090013899375,
        3.7164159984968137,
        2.3628159979125485,
        3.374918000190519,
        2.398933000222314,
        2.2169640033098403,
        2.1794029999000486,
        2.203898999141529,
        3.264170001784805,
        2.578108000307111,
        2.3546909978904296,
        2.839646997017553,
        2.9470379995473195,
        3.003793997777393,
        2.9761219993815757,
        3.0399220013350714,
        2.9935850034235045
      ],
      "train_losses": [
        0.10321581363677979,
        0.09891904890537262,
        0.09223386645317078,
        0.09084061533212662,
        0.0872407928109169,
        0.08475422114133835,
        0.08281916379928589,
        0.07993527501821518,
        0.0754813402891159,
        0.07552285492420197,
        0.07032604515552521,
        0.07025869190692902,
        0.06717514991760254,
        0.06696297228336334,
        0.06455450505018234,
        0.062425605952739716,
        0.06052825227379799,
        0.060636796057224274,
        0.0593060627579689,
        0.05764202028512955,
        0.05540398880839348,
        0.05566767230629921,
        0.05363991856575012,
        0.05205496400594711
      ],
      "active_layers_hist": [
        6,
        6,
        6,
        6,
        4,
        6,
        4,
        4,
        4,
        4,
        6,
        4,
        4,
        4,
        4,
        6,
        4,
        4,
        6,
        6,
        6,
        6,
        6,
        6
      ],
      "dynamic_trace": [
        {
          "step": 0,
          "probe": true,
          "probe_loss": 0.10321581363677979,
          "best_probe_loss": 0.10321581363677979,
          "active_budget": 4,
          "active_start_next": 2,
          "active_layers_next": 4,
          "ema_scores": [
            0.0004283553974225147,
            0.00042162158131086555,
            0.00040207223409191887,
            0.00038743955145400453,
            0.00037490999087206564,
            0.0003680440206719712
          ]
        },
        {
          "step": 1,
          "probe": true,
          "probe_loss": 0.09891904890537262,
          "best_probe_loss": 0.09891904890537262,
          "active_budget": 4,
          "active_start_next": 2,
          "active_layers_next": 4,
          "ema_scores": [
            0.0007591944182475073,
            0.0007322106135286309,
            0.0007005644015259695,
            0.0006674411517840143,
            0.000655238571640914,
            0.0006368929727328296
          ]
        },
        {
          "step": 2,
          "probe": true,
          "probe_loss": 0.09223386645317078,
          "best_probe_loss": 0.09223386645317078,
          "active_budget": 4,
          "active_start_next": 2,
          "active_layers_next": 4,
          "ema_scores": [
            0.0010389121496199877,
            0.000999533312147811,
            0.0009425767652665961,
            0.000899501587258119,
            0.0008847244836056253,
            0.0008532679745867401
          ]
        },
        {
          "step": 3,
          "probe": true,
          "probe_loss": 0.09084061533212662,
          "best_probe_loss": 0.09084061533212662,
          "active_budget": 4,
          "active_start_next": 2,
          "active_layers_next": 4,
          "ema_scores": [
            0.0012792216027876497,
            0.0012307799531193792,
            0.0011651779537496577,
            0.001118405864735886,
            0.0010902459025791602,
            0.001051582404742877
          ]
        },
        {
          "step": 5,
          "probe": true,
          "probe_loss": 0.08475422114133835,
          "best_probe_loss": 0.08475422114133835,
          "active_budget": 4,
          "active_start_next": 2,
          "active_layers_next": 4,
          "ema_scores": [
            0.001479662047735805,
            0.0014224002759712464,
            0.001347734586534783,
            0.0012908927032959758,
            0.0012608977468837187,
            0.0012088053844082826
          ]
        },
        {
          "step": 10,
          "probe": true,
          "probe_loss": 0.07032604515552521,
          "best_probe_loss": 0.07032604515552521,
          "active_budget": 4,
          "active_start_next": 2,
          "active_layers_next": 4,
          "ema_scores": [
            0.001608736538019353,
            0.001541382618611376,
            0.0014594707099114172,
            0.0013941679134602193,
            0.0013624784028772308,
            0.001305053501340711
          ]
        },
        {
          "step": 15,
          "probe": true,
          "probe_loss": 0.062425605952739716,
          "best_probe_loss": 0.062425605952739716,
          "active_budget": 4,
          "active_start_next": 2,
          "active_layers_next": 4,
          "ema_scores": [
            0.0017044130932639071,
            0.001634999644306243,
            0.0015344058057636491,
            0.0014612752705275489,
            0.0014310900789527708,
            0.0013661559749416302
          ]
        }
      ]
    }
  }
}