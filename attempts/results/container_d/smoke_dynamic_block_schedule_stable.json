{
  "script": "dynamic_block_update_schedule_bench.py",
  "timestamp_utc": "2026-02-25T19:33:49Z",
  "config": {
    "device_arg": "cpu",
    "resolved_device": "cpu",
    "dtype": "float32",
    "seed": 42,
    "dmodel": 128,
    "n_layers": 6,
    "hidden_mult": 2,
    "batch_size": 2,
    "seq_len": 64,
    "steps": 30,
    "equal_time_budget": true,
    "max_steps_multiplier": 2.0,
    "lr": 0.0003,
    "weight_decay": 0.0,
    "teacher_noise": 0.02,
    "val_batches": 2,
    "warmup_ignore_steps": 5,
    "static_active_layers": 2,
    "dyn_warmup_steps": 4,
    "dyn_probe_every": 5,
    "dyn_refresh_every": 20,
    "dyn_relevance_threshold": 0.8,
    "dyn_min_active_layers": 2,
    "dyn_max_active_layers": 4,
    "dyn_adapt_budget": true,
    "dyn_freeze_start_step": -1,
    "dyn_freeze_start_frac": 0.4,
    "dyn_require_stable": true,
    "dyn_stability_window": 4,
    "dyn_stability_rel_change": 0.05,
    "dyn_stability_cv": 0.05,
    "dyn_final_full_frac": 0.2,
    "dyn_loss_upper": 1.03,
    "dyn_loss_lower": 0.995,
    "dyn_budget_step_up": 2,
    "dyn_budget_step_down": 1,
    "dyn_loss_ema_decay": 0.9,
    "dyn_ema_decay": 0.9,
    "dyn_eps": 1e-08
  },
  "system": {
    "cuda_available": false,
    "cuda_device_name": null,
    "torch_version": "2.9.1+cu128"
  },
  "results": [
    {
      "schedule": "full_update",
      "steps_executed": 30,
      "elapsed_ms": 92.71276199797285,
      "final_val_loss": 0.04270154610276222,
      "train_loss_start": 0.10606145113706589,
      "train_loss_end": 0.04268322512507439,
      "mean_step_ms": 2.8769153999746777,
      "p50_step_ms": 2.811344002111582,
      "p90_step_ms": 2.9250759980641305,
      "speedup_vs_full": 1.0,
      "active_layers_mean": 6.0,
      "active_layers_min": 6,
      "active_layers_max": 6,
      "probe_step_count": 0,
      "notes": "full update"
    },
    {
      "schedule": "static_suffix",
      "steps_executed": 60,
      "elapsed_ms": 87.59628100597183,
      "final_val_loss": 0.04266618750989437,
      "train_loss_start": 0.10334963351488113,
      "train_loss_end": 0.043183568865060806,
      "mean_step_ms": 1.4530351274350488,
      "p50_step_ms": 1.4498290001938585,
      "p90_step_ms": 1.4780820019950625,
      "speedup_vs_full": 1.979935202979652,
      "active_layers_mean": 2.0,
      "active_layers_min": 2,
      "active_layers_max": 2,
      "probe_step_count": 0,
      "notes": "static active suffix=2"
    },
    {
      "schedule": "dynamic_suffix",
      "steps_executed": 32,
      "elapsed_ms": 95.49010300179361,
      "final_val_loss": 0.041482217609882355,
      "train_loss_start": 0.10517670959234238,
      "train_loss_end": 0.04399159550666809,
      "mean_step_ms": 2.904560777770476,
      "p50_step_ms": 2.8224739980942104,
      "p90_step_ms": 3.0642860001535155,
      "speedup_vs_full": 0.9904820797666287,
      "active_layers_mean": 6.0,
      "active_layers_min": 6,
      "active_layers_max": 6,
      "probe_step_count": 8,
      "notes": "dynamic relevance-guided active suffix + adaptive budget + stability-gated freeze + final_full_frac=0.2"
    }
  ],
  "traces": {
    "full_update": {
      "step_times_ms": [
        9.280471000238322,
        3.16061600096873,
        2.7907539988518693,
        2.7667499998642597,
        2.7912859986827243,
        2.851338002074044,
        2.78161699679913,
        4.123024002183229,
        2.8166230003989767,
        2.9444120009429753,
        2.797316999931354,
        2.7554689986573067,
        2.765638000710169,
        2.9250759980641305,
        2.8715760017803404,
        2.767120000498835,
        2.7982790015812498,
        2.7986390014120843,
        2.8358189993014093,
        2.916599998570746,
        2.785394997772528,
        2.8215120000822935,
        2.794310999888694,
        2.7876400017703418,
        2.7894419981748797,
        2.8046709994669072,
        2.8203799993207213,
        2.9086350004945416,
        2.851007997378474,
        2.811344002111582
      ],
      "train_losses": [
        0.10606145113706589,
        0.0991494283080101,
        0.09141726791858673,
        0.08918788284063339,
        0.08779001235961914,
        0.08280280232429504,
        0.08058103919029236,
        0.07848659157752991,
        0.07538919895887375,
        0.07147415727376938,
        0.07082254439592361,
        0.06713829934597015,
        0.06655574589967728,
        0.06444848328828812,
        0.061610929667949677,
        0.060430992394685745,
        0.058125630021095276,
        0.055908653885126114,
        0.05596281588077545,
        0.053634993731975555,
        0.0522225946187973,
        0.05232590064406395,
        0.05188244581222534,
        0.04837242513895035,
        0.04877101257443428,
        0.048036132007837296,
        0.0464952178299427,
        0.04654395580291748,
        0.04437560215592384,
        0.04268322512507439
      ],
      "active_layers_hist": [
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6
      ],
      "dynamic_trace": []
    },
    "static_suffix": {
      "step_times_ms": [
        1.6318689995387103,
        1.609196999197593,
        1.5217440013657324,
        1.4675919992441777,
        1.4489469976979308,
        1.51207599992631,
        1.44442900273134,
        1.4773210023122374,
        1.4699769999424461,
        1.5276649974111933,
        1.448786999389995,
        1.471469000534853,
        1.4409619980142452,
        1.454197001294233,
        1.4620620022469666,
        1.4587160003429744,
        1.4456610006163828,
        1.4549279985658359,
        1.4471540016529616,
        1.451301999622956,
        1.4415240002563223,
        1.4780820019950625,
        1.4688139999634586,
        1.4386879993253388,
        1.4520429976982996,
        1.4785530001972802,
        1.4653990001534112,
        1.4606390031985939,
        1.452203003282193,
        1.4252030014176853,
        1.4333079998323228,
        1.479894999647513,
        1.4219869990483858,
        1.4446799978031777,
        1.438298000721261,
        1.4420449988392647,
        1.4399809988390189,
        1.4741550003236625,
        1.4637349995609839,
        1.4672819997940678,
        1.4425959998334292,
        1.4495979994535446,
        1.4662700014014263,
        1.4534660003846511,
        1.4429360016947612,
        1.4506309998978395,
        1.4195620024111122,
        1.4498290001938585,
        1.4381679975485895,
        1.4591660001315176,
        1.4322269998956472,
        1.437947001249995,
        1.4265150020946749,
        1.4349509983730968,
        1.426585000444902,
        1.4254939997044858,
        1.4380979991983622,
        1.5053030001581647,
        1.425523998477729,
        1.458845999877667
      ],
      "train_losses": [
        0.10334963351488113,
        0.099179707467556,
        0.09812093526124954,
        0.09558634459972382,
        0.09318675100803375,
        0.09167705476284027,
        0.09041349589824677,
        0.0871911495923996,
        0.08402566611766815,
        0.08456271886825562,
        0.08335966616868973,
        0.08063528686761856,
        0.07830548286437988,
        0.07681214809417725,
        0.0738755390048027,
        0.0758461207151413,
        0.07147575914859772,
        0.0719938576221466,
        0.06971866637468338,
        0.06982579082250595,
        0.06760315597057343,
        0.07026958465576172,
        0.06551575660705566,
        0.0649782046675682,
        0.06375851482152939,
        0.06367699801921844,
        0.060823217034339905,
        0.061606403440237045,
        0.06072575971484184,
        0.057794179767370224,
        0.05842600390315056,
        0.05860574543476105,
        0.05690818279981613,
        0.05768105387687683,
        0.05461009219288826,
        0.05576879531145096,
        0.05418330803513527,
        0.05367415398359299,
        0.054624684154987335,
        0.05302342399954796,
        0.05253490060567856,
        0.052964504808187485,
        0.05050276964902878,
        0.05108689144253731,
        0.05138414725661278,
        0.047742344439029694,
        0.048848770558834076,
        0.048427216708660126,
        0.04641128331422806,
        0.04805789142847061,
        0.04536747932434082,
        0.04681186378002167,
        0.04640721157193184,
        0.045680608600378036,
        0.04472830519080162,
        0.0442630760371685,
        0.04464724287390709,
        0.04219171404838562,
        0.04407291114330292,
        0.043183568865060806
      ],
      "active_layers_hist": [
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2
      ],
      "dynamic_trace": []
    },
    "dynamic_suffix": {
      "step_times_ms": [
        4.694141000072705,
        3.233973002352286,
        3.123136000795057,
        3.089464000368025,
        2.926247998402687,
        3.119389002677053,
        2.836371000739746,
        2.818405999278184,
        2.800943999318406,
        4.017567000119016,
        3.0642860001535155,
        2.883599001506809,
        2.8313510010775644,
        2.7884910014108755,
        2.8318109980318695,
        3.0729019999853335,
        2.798689998599002,
        2.811694001138676,
        2.8224739980942104,
        2.8159219982626382,
        3.0312939998111688,
        2.9094059973431285,
        2.777450001303805,
        2.8222430009918753,
        2.844405000359984,
        2.882656997826416,
        2.8042000012646895,
        2.7873079998244066,
        2.845676997822011,
        2.803909002977889,
        2.820960999088129,
        2.779734000796452
      ],
      "train_losses": [
        0.10517670959234238,
        0.09804792702198029,
        0.09249022603034973,
        0.09056349843740463,
        0.08723347634077072,
        0.08455885201692581,
        0.08060074597597122,
        0.07588653266429901,
        0.07437602430582047,
        0.07115790247917175,
        0.0704711303114891,
        0.06989649683237076,
        0.06731738150119781,
        0.06507279723882675,
        0.06197664886713028,
        0.05918092653155327,
        0.057210177183151245,
        0.05716579407453537,
        0.05645707622170448,
        0.05273711308836937,
        0.0515747033059597,
        0.05150206387042999,
        0.050862669944763184,
        0.049054909497499466,
        0.047466009855270386,
        0.046028342097997665,
        0.04654765501618385,
        0.045516643673181534,
        0.04412173479795456,
        0.043421171605587006,
        0.04308927804231644,
        0.04399159550666809
      ],
      "active_layers_hist": [
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6,
        6
      ],
      "dynamic_trace": [
        {
          "step": 0,
          "probe": true,
          "freeze_enabled": false,
          "probe_loss": 0.10517670959234238,
          "best_probe_loss": 0.10517670959234238,
          "probe_loss_ema_prev": null,
          "probe_loss_ema": 0.10517670959234238,
          "active_budget": 4,
          "active_start_next": 2,
          "active_layers_next": 4,
          "ema_scores": [
            0.00044538059696154546,
            0.00043076309919315176,
            0.00041742484452311654,
            0.0004120330588227661,
            0.0004008941182088108,
            0.00038511358631349615
          ]
        },
        {
          "step": 1,
          "probe": true,
          "freeze_enabled": false,
          "probe_loss": 0.09804792702198029,
          "best_probe_loss": 0.09804792702198029,
          "probe_loss_ema_prev": 0.10517670959234238,
          "probe_loss_ema": 0.10446383133530616,
          "active_budget": 3,
          "active_start_next": 3,
          "active_layers_next": 3,
          "ema_scores": [
            0.0007684050307552766,
            0.0007365746873649336,
            0.0007134954256086776,
            0.0006850100158869725,
            0.000673177321824482,
            0.0006541605741365196
          ]
        },
        {
          "step": 2,
          "probe": true,
          "freeze_enabled": false,
          "probe_loss": 0.09249022603034973,
          "best_probe_loss": 0.09249022603034973,
          "probe_loss_ema_prev": 0.10446383133530616,
          "probe_loss_ema": 0.10326647080481052,
          "active_budget": 2,
          "active_start_next": 4,
          "active_layers_next": 2,
          "ema_scores": [
            0.0010395657303760358,
            0.0010025339718397065,
            0.0009660852839720568,
            0.0009204227833569945,
            0.0008972647864754029,
            0.000873007576060967
          ]
        },
        {
          "step": 3,
          "probe": true,
          "freeze_enabled": false,
          "probe_loss": 0.09056349843740463,
          "best_probe_loss": 0.09056349843740463,
          "probe_loss_ema_prev": 0.10326647080481052,
          "probe_loss_ema": 0.10199617356806993,
          "active_budget": 2,
          "active_start_next": 4,
          "active_layers_next": 2,
          "ema_scores": [
            0.0012838238163630975,
            0.0012386036423487413,
            0.0011904929262916645,
            0.0011410859018033714,
            0.0011091042969018504,
            0.0010707225956433613
          ]
        },
        {
          "step": 5,
          "probe": true,
          "freeze_enabled": false,
          "probe_loss": 0.08455885201692581,
          "best_probe_loss": 0.08455885201692581,
          "probe_loss_ema_prev": 0.10199617356806993,
          "probe_loss_ema": 0.10025244141295551,
          "active_budget": 2,
          "active_start_next": 4,
          "active_layers_next": 2,
          "ema_scores": [
            0.0014796748956616033,
            0.0014220463019516234,
            0.0013647230091745953,
            0.001309414392068472,
            0.0012738364821496951,
            0.0012251753402277884
          ]
        },
        {
          "step": 10,
          "probe": true,
          "freeze_enabled": false,
          "probe_loss": 0.0704711303114891,
          "best_probe_loss": 0.0704711303114891,
          "probe_loss_ema_prev": 0.10025244141295551,
          "probe_loss_ema": 0.09727431030280888,
          "active_budget": 2,
          "active_start_next": 4,
          "active_layers_next": 2,
          "ema_scores": [
            0.001610812199089384,
            0.0015350056155474764,
            0.001473230561938312,
            0.001414818569235967,
            0.0013797181724293358,
            0.0013242729849615702
          ]
        },
        {
          "step": 15,
          "probe": true,
          "freeze_enabled": false,
          "probe_loss": 0.05918092653155327,
          "best_probe_loss": 0.05918092653155327,
          "probe_loss_ema_prev": 0.09727431030280888,
          "probe_loss_ema": 0.09346497192568332,
          "active_budget": 2,
          "active_start_next": 4,
          "active_layers_next": 2,
          "ema_scores": [
            0.0016892824012182273,
            0.001604964206903461,
            0.0015369479189328535,
            0.0014747029381747766,
            0.0014392456136909726,
            0.001382424489805973
          ]
        },
        {
          "step": 20,
          "probe": true,
          "freeze_enabled": false,
          "probe_loss": 0.0515747033059597,
          "best_probe_loss": 0.0515747033059597,
          "probe_loss_ema_prev": 0.09346497192568332,
          "probe_loss_ema": 0.08927594506371095,
          "active_budget": 2,
          "active_start_next": 4,
          "active_layers_next": 2,
          "ema_scores": [
            0.0017355684436552643,
            0.00163925007573676,
            0.0015736434739025093,
            0.0015042493492525928,
            0.001467488132096657,
            0.0014063200558969413
          ]
        }
      ]
    }
  }
}